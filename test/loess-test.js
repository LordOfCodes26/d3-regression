const tape = require("tape"),
      d3 = require("../");

tape("loess.bandwidth(bandwidth) sets the bandwiddth explicitly", function(test) {
  const r = d3.regressionLoess().bandwidth(.5);
  test.equal(r.bandwidth(), .5);
  test.end();
});

tape("loess(data) calculates the LOESS regression", function(test) {
  const data = [[1900, 57.5605], [1901, 57.3214], [1902, 56.2134], [1903, 56.317], [1904, 57.4467], [1905, 57.1332], [1906, 57.2392], [1907, 56.5545], [1908, 56.2721], [1909, 56.2912], [1910, 57.7532], [1911, 55.474], [1912, 55.5628], [1913, 56.5263], [1914, 57.4455], [1915, 56.8189], [1916, 55.5932], [1917, 56.6997], [1918, 56.9079], [1919, 56.3611], [1920, 56.1257], [1921, 57.3778], [1922, 56.1452], [1923, 56.4466], [1924, 57.1546], [1925, 57.206], [1926, 58.8471], [1927, 56.94], [1928, 57.7148], [1929, 57.3422], [1930, 56.9745], [1931, 58.3638], [1932, 56.9607], [1933, 56.8247], [1934, 59.7805], [1935, 56.8945], [1936, 58.6637], [1937, 57.2449], [1938, 57.3329], [1939, 58.4247], [1940, 58.8798], [1941, 57.1222], [1942, 57.1411], [1943, 57.894], [1944, 56.2842], [1945, 57.1573], [1946, 56.8022], [1947, 57.6003], [1948, 55.6891], [1949, 56.2792], [1950, 58.1899], [1951, 57.2899], [1952, 56.8036], [1953, 57.2433], [1954, 57.6142], [1955, 56.3011], [1956, 57.0172], [1957, 57.1288], [1958, 58.9603], [1959, 59.0416], [1960, 58.0866], [1961, 57.8652], [1962, 57.4384], [1963, 57.1077], [1964, 56.6202], [1965, 56.774], [1966, 58.0992], [1967, 57.5668], [1968, 57.5989], [1969, 57.5899], [1970, 57.8767], [1971, 56.2718], [1972, 57.2934], [1973, 57.3641], [1974, 57.7036], [1975, 56.3447], [1976, 57.5107], [1977, 58.0088], [1978, 57.6893], [1979, 57.7485], [1980, 58.1052], [1981, 59.3551], [1982, 56.4003], [1983, 57.6184], [1984, 58.2609], [1985, 57.3929], [1986, 58.9427], [1987, 58.3293], [1988, 58.7852], [1989, 58.1885], [1990, 58.0488], [1991, 58.16], [1992, 59.2918], [1993, 57.7408], [1994, 58.1055], [1995, 58.9677], [1996, 59.594], [1997, 59.1923], [1998, 56.7942], [1999, 58.0356], [2000, 58.8363], [2001, 59.2216], [2002, 58.8964], [2003, 59.529], [2004, 58.9128], [2005, 58.6833], [2006, 58.6975], [2007, 58.9929], [2008, 58.9459], [2009, 58.917], [2010, 57.7926], [2011, 57.5186], [2012, 59.5448], [2013, 59.3921], [2014, 61.5208], [2015, 60.7992], [2016, 60.1429], [2017, 60.4208]];
  const r = d3.regressionLoess()
    (data);

  const output = [[1900, 56.84203603813782], [1901, 56.823880420718446], [1902, 56.80701898284934], [1903, 56.79143996827244], [1904, 56.77718378265264], [1905, 56.764334791721026], [1906, 56.75292962790934], [1907, 56.742948891544685], [1908, 56.7343178716496], [1909, 56.72695170364518], [1910, 56.72078756696167], [1911, 56.71576021371146], [1912, 56.71169992034994], [1913, 56.708473636333025], [1914, 56.706088093156396], [1915, 56.704805348939644], [1916, 56.70576431788093], [1917, 56.712320261499315], [1918, 56.74790001230659], [1919, 56.78942069380828], [1920, 56.83748213534294], [1921, 56.892250522642726], [1922, 56.9519945022072], [1923, 57.01443861565069], [1924, 57.07859385148976], [1925, 57.144733927422436], [1926, 57.21214134229599], [1927, 57.27901032976064], [1928, 57.34308640132373], [1929, 57.402830476804354], [1930, 57.45672812128815], [1931, 57.502547433375774], [1932, 57.538267285588205], [1933, 57.56195639243931], [1934, 57.57327443318944], [1935, 57.573481375258496], [1936, 57.56400274816275], [1937, 57.54670946886343], [1938, 57.52367643827736], [1939, 57.49687396721647], [1940, 57.46813369606997], [1941, 57.43860331605791], [1942, 57.40872244047533], [1943, 57.379879015546464], [1944, 57.35366139781637], [1945, 57.33184808181214], [1946, 57.315396344091], [1947, 57.30449888731605], [1948, 57.29847592437331], [1949, 57.29553740443236], [1950, 57.295218793235115], [1951, 57.29801854281826], [1952, 57.30344082613656], [1953, 57.31226477763198], [1954, 57.325100636149365], [1955, 57.34264762617618], [1956, 57.36367811839715], [1957, 57.38591358081202], [1958, 57.40755388563371], [1959, 57.42815511755061], [1960, 57.44632106674753], [1961, 57.46071240516163], [1962, 57.47141634618098], [1963, 57.478388358378105], [1964, 57.48179755794635], [1965, 57.48281654883124], [1966, 57.48432192231563], [1967, 57.48668592399362], [1968, 57.488693587174225], [1969, 57.49026517739027], [1970, 57.49205947840214], [1971, 57.49573834430311], [1972, 57.50354685608484], [1973, 57.51870609185366], [1974, 57.542989580038345], [1975, 57.575914537813844], [1976, 57.61500221122252], [1977, 57.6582639269681], [1978, 57.70391757981052], [1979, 57.75071604156152], [1980, 57.79897718774309], [1981, 57.85045711635622], [1982, 57.90635482156091], [1983, 57.964751274340856], [1984, 58.02271561324122], [1985, 58.078455983924215], [1986, 58.131195699805794], [1987, 58.180850728139156], [1988, 58.2281210345491], [1989, 58.2741870391406], [1990, 58.319185780449104], [1991, 58.36292543303722], [1992, 58.40569657511495], [1993, 58.44831291989382], [1994, 58.49033169345141], [1995, 58.53005874798739], [1996, 58.565725371856786], [1997, 58.596576567104606], [1998, 58.62266138294266], [1999, 58.64611783088645], [2000, 58.67140622932628], [2001, 58.710655772443296], [2002, 58.762536824662064], [2003, 58.82053995659611], [2004, 58.88112858108546], [2005, 58.94258080709339], [2006, 59.00406425615312], [2007, 59.06520536608269], [2008, 59.12587277880276], [2009, 59.1860585879776], [2010, 59.24583648641978], [2011, 59.30536787975812], [2012, 59.36498198843149], [2013, 59.42515299604777], [2014, 59.486332424632316], [2015, 59.548889913008765], [2016, 59.61298575584964], [2017, 59.6786275397784]];
  
  test.deepEqual(r, output);
  test.end();
});