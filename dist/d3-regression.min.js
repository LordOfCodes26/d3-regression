!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):(n=n||self,r(n.d3=n.d3||{}))}(this,function(n){"use strict";function r(n,r,t,e,o){for(var u=n.length,a=0,f=0,i=0;i<u;i++){var c=n[i],h=r(c),v=t(c),l=o(h);a+=Math.pow(v-l,2),f+=Math.pow(v-e/u,2)}return 1-a/f}function t(n){return 180*Math.atan2(n[1][1]-n[0][1],n[1][0]-n[0][0])/Math.PI}function e(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]}function o(n,r,o){function u(n){return[n,o(n)]}for(var a=.01,f=[u(n),u(r)],i=0;function(n){i++;for(var r=n.length,o=!1,f=0;f<r-1;f++){var c=n[f],h=n[f+1],v=e([c,h]),l=u(v[0]),g=t([c,v]),M=t([c,l]);Math.abs(g-M)>a&&(n.splice(f+1,0,l),o=!0)}return o}(f)&&i<1e4;);return f}function u(){function n(n){for(var a=n.length,f=0,i=0,c=0,h=0,v=0,l=t?+t[0]:1/0,g=t?+t[1]:-(1/0),M=0;M<a;M++){var s=n[M],d=e(s,M,n),p=u(s,M,n);f+=p,i+=d*d*p,c+=p*Math.log(p),h+=d*p*Math.log(p),v+=d*p,t||(d<l&&(l=d),d>g&&(g=d))}var w=f*i-v*v,b=Math.exp((i*c-v*h)/w),x=(f*h-v*c)/w,y=function(n){return b*Math.exp(x*n)},m=o(l,g,y);return m.a=b,m.b=x,m.predict=y,m.rSquared=r(n,e,u,f,y),m}var t,e=function(n){return n[0]},u=function(n){return n[1]};return n.domain=function(r){return arguments.length?(t=r,n):t},n.x=function(r){return arguments.length?(e=r,n):e},n.y=function(r){return arguments.length?(u=r,n):u},n}function a(){function n(n){for(var u=n.length,a=0,f=0,i=0,c=0,h=t?+t[0]:1/0,v=t?+t[1]:-(1/0),l=0;l<u;l++){var g=n[l],M=e(g,l,n),s=o(g,l,n);a+=M,f+=s,i+=M*s,c+=M*M,t||(M<h&&(h=M),M>v&&(v=M))}var d=u*i,p=a*f,w=u*c,b=a*a,x=(d-p)/(w-b),y=f,m=x*a,q=(y-m)/u,S=function(n){return x*n+q},P=r(n,e,o,f,S),L=[[h,h*x+q],[v,v*x+q]];return L.a=x,L.b=q,L.predict=S,L.rSquared=P,L}var t,e=function(n){return n[0]},o=function(n){return n[1]};return n.domain=function(r){return arguments.length?(t=r,n):t},n.x=function(r){return arguments.length?(e=r,n):e},n.y=function(r){return arguments.length?(o=r,n):o},n}function f(n){n.sort(function(n,r){return n-r});var r=n.length/2;return r%1==0?(n[r-1]+n[r])/2:n[Math.floor(r)]}function i(n,r){return n.sort(function(n,t){return r(n)-r(t)})}function c(){function n(n){i(n,r);for(var a=n.length,c=[],M=[],s=[],d=0;d<a;d++){s[d]=1;var p=n[d];c[d]=r(p,d,n),M[d]=t(p,d,n)}h(c),h(M),h(s),v(c);var w=Math.floor(e*a);if(w<2)throw{error:"Bandwidth too small."};for(var b=[],x=[],y=[],m=0;m<a;m++)b[m]=0,x[m]=0,y[m]=1;for(var q=-1;++q<=o;){for(var S=[0,w-1],P=void 0,L=0;L<a;L++){P=c[L],L>0&&g(c,s,L,S);for(var j=S[0],k=S[1],_=c[L]-c[j]>c[k]-c[L]?j:k,B=0,E=0,F=0,I=0,O=0,Q=Math.abs(1/(c[_]-P)),z=j;z<=k;++z){var A=c[z],C=M[z],D=z<L?P-A:A-P,G=l(D*Q)*y[z]*s[z],H=A*G;B+=G,E+=H,F+=A*H,I+=C*G,O+=C*H}var J=E/B,K=I/B,N=O/B,R=F/B,T=Math.sqrt(Math.abs(R-J*J))<u?0:(N-J*K)/(R-J*J),U=K-T*J;b[L]=T*P+U,x[L]=Math.abs(M[L]-b[L])}if(q===o)break;var V=f(x);if(Math.abs(V)<u)break;for(var W=void 0,X=void 0,Y=0;Y<a;Y++)W=x[Y]/(6*V),y[Y]=W>=1?0:(X=1-W*W)*X}return b.map(function(n,r){return[c[r],n]})}var r=function(n){return n[0]},t=function(n){return n[1]},e=.3,o=2,u=1e-12;return n.bandwidth=function(r){return arguments.length?(e=r,n):e},n.x=function(t){return arguments.length?(r=t,n):r},n.y=function(r){return arguments.length?(t=r,n):t},n}function h(n){for(var r=0,t=n.length;r<t;r++)if(!isFinite(n[r]))return!1;return!0}function v(n){for(var r=0,t=n.length;r<t;r++)if(n[r-1]>=n[r])return!1;return!0}function l(n){return(n=1-n*n*n)*n*n}function g(n,r,t,e){var o=e[0],u=e[1],a=M(r,u);if(a<n.length&&n[a]-n[t]<n[t]-n[o]){var f=M(r,o);e[0]=f,e[1]=a}}function M(n,r){for(var t=r+1;t<n.length&&0===n[t];)t++;return t}function s(){function n(n){for(var a=n.length,f=0,i=0,c=0,h=0,v=t?+t[0]:1/0,l=t?+t[1]:-(1/0),g=0;g<a;g++){var M=n[g],s=e(M,g,n),d=u(M,g,n);f+=Math.log(s),i+=d*Math.log(s),c+=d,h+=Math.pow(Math.log(s),2),t||(s<v&&(v=s),s>l&&(l=s))}var p=(a*i-c*f)/(a*h-f*f),w=(c-p*f)/a,b=function(n){return p*Math.log(n)+w},x=o(v,l,b);return x.a=p,x.b=w,x.predict=b,x.rSquared=r(n,e,u,c,b),x}var t,e=function(n){return n[0]},u=function(n){return n[1]};return n.domain=function(r){return arguments.length?(t=r,n):t},n.x=function(r){return arguments.length?(e=r,n):e},n.y=function(r){return arguments.length?(u=r,n):u},n}function d(){function n(n){for(var f=n.length,i=[],c=0,h=t?+t[0]:1/0,v=t?+t[1]:-(1/0),l=0;l<f;l++){var g=n[l],M=e(g,l,n),s=u(g,l,n);i[l]=[M,s],c+=s,t||(M<h&&(h=M),M>v&&(v=M))}for(var d=[],w=[],b=a+1,x=0,y=0,m=0;m<b;m++){for(var q=0;q<f;q++)x+=Math.pow(i[q][0],m)*i[q][1];d.push(x),x=0;for(var S=[],P=0;P<b;P++){for(var L=0;L<f;L++)y+=Math.pow(i[L][0],m+P);S[P]=y,y=0}w.push(S)}w.push(d);var j=p(w,b),k=function(n){return j.reduce(function(r,t,e){return r+t*Math.pow(n,e)},0)},_=o(h,v,k);return _.coefficients=j,_.predict,_.rSquared=r(n,e,u,c,k),_}var t,e=function(n){return n[0]},u=function(n){return n[1]},a=3;return n.domain=function(r){return arguments.length?(t=r,n):t},n.x=function(r){return arguments.length?(e=r,n):e},n.y=function(r){return arguments.length?(u=r,n):u},n.order=function(r){return arguments.length?(a=r,n):a},n}function p(n,r){for(var t=n.length-1,e=[r],o=0;o<t;o++){for(var u=o,a=o+1;a<t;a++)Math.abs(n[o][a])>Math.abs(n[o][u])&&(u=a);for(var f=o;f<t+1;f++){var i=n[f][o];n[f][o]=n[f][u],n[f][u]=i}for(var c=o+1;c<t;c++)for(var h=t;h>=o;h--)n[h][c]-=n[h][o]*n[o][c]/n[o][o]}for(var v=t-1;v>=0;v--){for(var l=0,g=v+1;g<t;g++)l+=n[g][v]*e[g];e[v]=(n[t][v]-l)/n[v][v]}return e}function w(){function n(n){for(var a=n.length,f=0,i=0,c=0,h=0,v=0,l=t?+t[0]:1/0,g=t?+t[1]:-(1/0),M=0;M<a;M++){var s=n[M],d=e(s,M,n),p=u(s,M,n);f+=Math.log(d),i+=Math.log(p)*Math.log(d),c+=Math.log(p),h+=Math.pow(Math.log(d),2),v+=p,t||(d<l&&(l=d),d>g&&(g=d))}var w=(a*i-f*c)/(a*h-Math.pow(f,2)),b=Math.exp((c-w*f)/a),x=function(n){return b*Math.pow(n,w)},y=o(l,g,x);return y.a=b,y.b=w,y.predict=x,y.rSquared=r(n,e,u,v,x),y}var t,e=function(n){return n[0]},u=function(n){return n[1]};return n.domain=function(r){return arguments.length?(t=r,n):t},n.x=function(r){return arguments.length?(e=r,n):e},n.y=function(r){return arguments.length?(u=r,n):u},n}function b(){function n(n){for(var a=n.length,f=0,i=0,c=0,h=0,v=0,l=0,g=0,M=t?+t[0]:1/0,s=t?+t[1]:-(1/0),d=0;d<a;d++){var p=n[d],w=e(p,d,n),b=u(p,d,n),x=Math.pow(w,2);f+=w,i+=b,c+=x,h+=Math.pow(w,3),v+=Math.pow(w,4),l+=w*b,g+=x*b,t||(w<M&&(M=w),w>s&&(s=w))}var y=c-Math.pow(f,2)/a,m=l-f*i/a,q=h-c*f/a,S=g-c*i/a,P=v-Math.pow(c,2)/a,L=(S*y-m*q)/(y*P-Math.pow(q,2)),j=(m*P-S*q)/(y*P-Math.pow(q,2)),k=i/a-j*(f/a)-L*(c/a),_=function(n){return L*Math.pow(n,2)+j*n+k},B=o(M,s,_);return B.a=L,B.b=j,B.c=k,B.predict=_,B.rSquared=r(n,e,u,i,_),B}var t,e=function(n){return n[0]},u=function(n){return n[1]};return n.domain=function(r){return arguments.length?(t=r,n):t},n.x=function(r){return arguments.length?(e=r,n):e},n.y=function(r){return arguments.length?(u=r,n):u},n}n.regressionExp=u,n.regressionLinear=a,n.regressionLoess=c,n.regressionLog=s,n.regressionPoly=d,n.regressionPow=w,n.regressionQuad=b,Object.defineProperty(n,"__esModule",{value:!0})});